# Video Generation Skill Package

## 技能定义

?????????????? ComfyUI ????wan2.2_generate_video.json?????????????????????? 302.ai API????????Image-to-Video???????????????????

## 调用时机

当需要进行以下任务时调用此技能：

### 图生视频任务
- 基于静态图像和文本提示词生成动态视频
- 将漫剧分镜图像转换为动态视频片段
- 批量图像到视频的自动化转换
- 视频首帧封面图提取

### API集成任务
- 集成到网文改编项目的完整制作流程中
- 自动化视频生成管道
- 异步任务状态监控和管理

### 批量处理
- 批量提交视频生成任务
- 管理多个异步任务的生命周期
- 统一的视频文件组织和命名

## 资源文件调用

### 核心方法论
- `video-generation-method.md` - 视频生成核心方法论
- 包含302.ai API调用规范
- Base64图像编码处理
- 异步任务管理策略

### Python实现
- `video_generator.py` - 视频生成核心实现
  - Video302AIClient：API客户端
  - VideoTaskManager：任务状态管理
  - VideoBatchProcessor：批量处理器
  - 图像处理工具函数

## 调用方式

```
调用 video-generation-skill 时需要读取：
1. video-generation-method.md（了解视频生成方法）
2. video_generator.py（执行视频生成）
3. 图像文件（05_generated_images/）
4. 视频提示词（07_video_prompts/）
5. generate_videos.py??????????
   python scripts/generate_videos.py <run_dir> [--download-only] [--provider {comfyui|302}]?
   ? ?? provider=comfyui????? 302.ai ??? `--provider 302` ??? VIDEO_GENERATION_PROVIDER=302
   ? ?? --download-only???????????
   ? ?? --download-only?????????/?????????

## ????
- ???????PNG/JPG??? <10MB?
- ????????????
- ???????????????
- ?? ComfyUI ?????
  - COMFYUI_SERVER_ADDRESS??? 127.0.0.1:8188?
  - COMFYUI_VIDEO_WORKFLOW??? comfyui-workflows/wan2.2_generate_video.json?
  - COMFYUI_INPUT_DIR?????? ComfyUI input ???
  - COMFYUI_VIDEO_TIMEOUT????????
- ??? 302.ai ?????
  - VIDEO_302AI_API_KEY?Bearer ...?

## 输出格式
- MP4视频文件（720P分辨率）
- 视频首帧封面图（PNG格式）
- 任务状态记录（video_tasks.json）
- 执行统计报告

## 专业能力

### API集成
- HTTP请求处理和错误管理
- Base64图像编码和解码
- 异步任务提交和状态轮询
- 视频文件下载和保存

### 任务管理
- JSON格式任务记录
- 任务状态持久化
- 断点续传支持
- 失败任务重试机制

### 视频处理
- OpenCV视频首帧提取
- 封面图自动生成
- 批量视频下载管理
- 文件组织和命名规范

## 使用场景

### 网文改编项目集成
- 将分镜静态图像批量转换为动态视频
- 为每个镜头生成对应的视频片段
- 生成Excel可嵌入的视频封面图

### 工作流自动化
### API??
- **?????**?ComfyUI??? server_address???? COMFYUI_SERVER_ADDRESS ???
- **?????**?comfyui-workflows/wan2.2_generate_video.json
- **?????**?302.ai?wan2.2-i2v-flash??? `--provider 302` ??? VIDEO_GENERATION_PROVIDER=302?
- **????**????? + ?????
- **????**?MP4 ?? + ????
### API服务
- **提供商**：302.ai
- **模型**：wan2.2-i2v-flash
- **分辨率**：720P
- **输入格式**：Base64编码的图像 + 文本提示词
- **输出格式**：MP4视频

### 性能指标
- **单视频生成时间**：2-4分钟
- **批量处理**：支持并行异步生成
- **成功率**：>95%（预期）
- **文件大小**：5-10MB/视频

???????? ComfyUI ? 302.ai ???????????????????????????????????????????
